name: Release Version

on:
  workflow_dispatch:
    inputs:
      fileName: 
        description: 'this is user input for c++ file'
        required: true
        default: 'new2.cpp'
        type: choice
        options:
          - new1.cpp
          - new2.cpp
          - new3.cpp
concurrency:  
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

# env:
#   FILE_NAME: index.cpp

permissions:
  contents: write
 
jobs:
  ubuntu-build:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
    - name: Checkout
      uses: actions/checkout@v2.0.0
    - name: Install g++ compiler
      run: sudo apt-get update && sudo apt-get install -y g++
    - name: Verify g++ version
      run: g++ --version
    - name: sleep
      run: sleep 60s
    - name: Build project
      run: |
    - name: Print the input tag to STDOUT
      run: echo  The tags are ${{ inputs.fileName }} 
        g++ -o "${{ inputs.fileName }}-out" "${{ inputs.fileName }}"

    - name: 'Upload Artifact'
      uses: actions/upload-artifact@v4
      with:
       name: my-artifact
       path: my_program        
    - name: Configure git to use GitHub Actions token
      run: |
          git config --local user.email "yan.khachaturyan95@gmail.com"
          git config --local user.name "yana-khachaturyan"
          git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}.git
      if: ${{success()}} 

